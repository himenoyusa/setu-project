# 图片展示网站接口文档

目录

1. <a href="#1">查询指定方式排序的缩略图</a>
1. <a href="#2">查询单张图片信息</a>
1. <a href="#3">上传图片</a>
1. <a href="#4">为图片评分</a>
1. <a href="#5">为图片添加 tag</a>

---

## **1. <span id="1">查询指定方式排序的缩略图</span>**

### 接口功能

> 获取首页显示图片所需的缩略图信息

### URL（请求地址）

> /api/getThumbList.php

### 请求方法

> GET

### 请求参数

| 参数      | 必选  | 类型   | 说明                                   |
| --------- | ----- | ------ | -------------------------------------- |
| page      | false | int    | 页码                                   |
| orderType | false | string | 排序方式，'time','score','default'可选 |
| r18       | false | bool   | 是否切换 R18 模式，默认 false          |

### 返回参数

> 成功时返回：

| 返回字段 | 字段类型 | 说明                                   |
| -------- | -------- | -------------------------------------- |
| data     | object   | 返回的数据                             |
| thumbs   | array    | 返回缩略图信息数组，每页默认最多 9 个  |
| total    | string   | 当前模式下缩略图总数，用于计算分页页数 |
| status   | bool     | 成功时返回 true                        |
| message  | string   | 请求反馈信息，默认为空                 |

_thumbs 字段数据结构说明_

| 返回字段    | 字段类型 | 说明                       |
| ----------- | -------- | -------------------------- |
| picture_id  | string   | 图片 id                    |
| thumb_dir   | string   | 缩略图路径                 |
| create_time | string   | 图片创建时间，（unix）格式 |
| total_score | string   | 图片总分数                 |

> 失败时返回：

| 返回字段 | 字段类型 | 说明                       |
| -------- | -------- | -------------------------- |
| data     | object   | 返回的数据,为空            |
| status   | bool     | 失败时返回 false           |
| message  | string   | 请求失败反馈信息、错误信息 |

### 接口示例

> 地址：<http://www.kanata.moe/api/getThumbList.php?page=1&orderType=time&r18=true>

```json
成功时返回：
{
    "data": {
        "thumbs":
        [
            0: {
                "picture_id": "1",
                "thumb_dir": "pictures/12.jpg",
                "create_time": "1453627345",
                "total_score": "80"
            },
            1: {
                "picture_id": "1",
                "thumb_dir": "pictures/12.jpg",
                "create_time": "1453627345",
                "total_score": "89"
            }
        ],
        "total": "50"
    },
    "status": true,
    "message": ""
}

失败时返回：
{
    "data": {},
    "status": false,
    "message": "service is busy"
}
```

## **2. <span id="2">查询单张图片完整信息</span>**

### 接口功能

> 获取单张图片的完整信息

### URL（请求地址）

> /api/getPicture.php

### 请求方法

> GET

### 请求参数

| 参数      | 必选 | 类型 | 说明      |
| --------- | ---- | ---- | --------- |
| pictureID | true | int  | 图片的 id |

### 返回参数

> 成功时返回：

| 返回字段     | 字段类型 | 说明                             |
| ------------ | -------- | -------------------------------- |
| data         | object   | 返回的数据                       |
| picture_info | object   | 返回图片完整信息                 |
| tags         | array    | 图片的所有 tag，没有则返回空数组 |
| status       | true     | 成功返回 true                    |
| message      | string   | 请求反馈信息，默认为空           |

_picture_info 字段数据结构说明_

| 返回字段    | 字段类型 | 说明                       |
| ----------- | -------- | -------------------------- |
| picture_id  | string   | 图片 id                    |
| picture_dir | string   | 图片原图路径               |
| thumb_dir   | string   | 缩略图路径                 |
| create_by   | string   | 创建图片的用户 id          |
| create_time | string   | 图片创建时间，（unix）格式 |
| edit_by     | string   | 修改图片的用户 id          |
| edit_time   | string   | 图片修改时间，（unix）格式 |

_tags 字段数据结构说明_

| 返回字段   | 字段类型 | 说明               |
| ---------- | -------- | ------------------ |
| tag_id     | string   | tag id             |
| tag        | string   | tag 内容           |
| picture_id | string   | tag 所属的图片 id  |
| create_by  | string   | 创建 tag 的用户 id |

> 失败时返回：

| 返回字段 | 字段类型 | 说明                       |
| -------- | -------- | -------------------------- |
| data     | object   | 返回的数据,为空            |
| status   | bool     | 失败返回 false             |
| message  | string   | 请求失败反馈信息、错误信息 |

### 接口示例

> 地址：<http://www.kanata.moe/api/getPicture.php?pictureID=1>

```json
成功时返回：
{
    "data": {
        "picture_info": {
                "picture_id":"1",
                "picture_dir":"src/favicon.png",
                "thumb_dir":"/home/yusa/Pictures/IMG_0184.PNG",
                "create_by":"1",
                "create_time":"1",
                "edit_by":"1",
                "edit_time":"1"
            },
        "tags": [
            0: {
                "tag_id":"1",
                "tag":"testtag",
                "picture_id":"1",
                "create_by":"1"
            },
            1: {
                "tag_id":"1",
                "tag":"testtag",
                "picture_id":"1",
                "create_by":"1"
            }
        ]
    },
    "status": true,
    "message": ""
}

失败时返回：
{
    "data": {},
    "status": false,
    "message": "pictureID is illegal"
}
```

## **3. <span id="3">上传图片</span>**

### 接口功能

> 上传图片

### URL（请求地址）

> /api/uploadPicture.php

### 请求方法

> POST

### 请求参数

| 参数 | 必选  | 类型 | 说明                       |
| ---- | ----- | ---- | -------------------------- |
| r18  | false | bool | 图片是否为 R18，默认 false |

### 返回参数

> 成功时返回：

| 返回字段 | 字段类型 | 说明                   |
| -------- | -------- | ---------------------- |
| status   | bool     | 成功时返回 true        |
| message  | string   | 请求反馈信息，默认为空 |

> 失败时返回：

| 返回字段 | 字段类型 | 说明                       |
| -------- | -------- | -------------------------- |
| status   | bool     | 失败时返回 false           |
| message  | string   | 请求失败反馈信息、错误信息 |

### 接口示例

> 地址：<http://www.kanata.moe/api/uploadPicture.php>

```json
成功时返回：
{
    "status": true,
    "message": ""
}

失败时返回：
{
    "status": false,
    "message": "service is busy"
}
```

## **4. <span id="4">为图片评分</span>**

### 接口功能

> 为单张图片进行百分制评分

### URL（请求地址）

> /api/addScore.php

### 请求方法

> POST

### 请求参数

| 参数      | 必选 | 类型 | 说明                   |
| --------- | ---- | ---- | ---------------------- |
| pictureID | true | int  | 图片 ID                |
| score     | true | int  | 分数，0-100 之间的整数 |

### 返回参数

> 成功时返回：

| 返回字段 | 字段类型 | 说明                   |
| -------- | -------- | ---------------------- |
| status   | bool     | 成功时返回 true        |
| message  | string   | 请求反馈信息，默认为空 |

> 失败时返回：

| 返回字段 | 字段类型 | 说明                       |
| -------- | -------- | -------------------------- |
| status   | bool     | 失败时返回 false           |
| message  | string   | 请求失败反馈信息、错误信息 |

### 接口示例

> 地址：<http://www.kanata.moe/api/addScore.php>

```json
成功时返回：
{
    "status": true,
    "message": ""
}

失败时返回：
{
    "status": false,
    "message": "service is busy"
}
```

## **4. <span id="4">为图片添加 tag</span>**

### 接口功能

> 为单张图片进行百分制评分

### URL（请求地址）

> /api/addTag.php

### 请求方法

> POST

### 请求参数

| 参数      | 必选 | 类型   | 说明                 |
| --------- | ---- | ------ | -------------------- |
| pictureID | true | int    | 图片 ID              |
| tag       | ture | string | 不超过 10 个中文字符 |

### 返回参数

> 成功时返回：

| 返回字段 | 字段类型 | 说明                   |
| -------- | -------- | ---------------------- |
| status   | bool     | 成功时返回 true        |
| message  | string   | 请求反馈信息，默认为空 |

> 失败时返回：

| 返回字段 | 字段类型 | 说明                       |
| -------- | -------- | -------------------------- |
| status   | bool     | 失败时返回 false           |
| message  | string   | 请求失败反馈信息、错误信息 |

### 接口示例

> 地址：<http://www.kanata.moe/api/addTag.php>

```json
成功时返回：
{
    "status": true,
    "message": ""
}

失败时返回：
{
    "status": false,
    "message": "service is busy"
}
```
